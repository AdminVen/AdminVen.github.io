<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>枫林晚</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Git 的基本操作、开发流程、实用技巧总结Git 是什么？Git 是一个分布式的代码管理容器，本地和远端都保有一份相同的代码。Git 仓库主要是由是三部分组成：本地代码，缓存区，提交历史，这几乎是所有操作的本质，但是为了文章更加简单易懂，就不围绕这块展开了，有兴趣的可以去了解下。开门见山，我们直接来说说 Git 有哪些常见的操作。 Git 有哪些常规操作？我们简单说说Git有哪些常规操作，能够让我">
<meta property="og:type" content="article">
<meta property="og:title" content="枫林晚">
<meta property="og:url" content="AdminVen.github.com/uncategorized/Git 的基本操作、开发流程、实用技巧总结/index.html">
<meta property="og:site_name" content="枫林晚">
<meta property="og:description" content="Git 的基本操作、开发流程、实用技巧总结Git 是什么？Git 是一个分布式的代码管理容器，本地和远端都保有一份相同的代码。Git 仓库主要是由是三部分组成：本地代码，缓存区，提交历史，这几乎是所有操作的本质，但是为了文章更加简单易懂，就不围绕这块展开了，有兴趣的可以去了解下。开门见山，我们直接来说说 Git 有哪些常见的操作。 Git 有哪些常规操作？我们简单说说Git有哪些常规操作，能够让我">
<meta property="og:locale" content="english">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504255445680_7621_1504255446676.png">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504255512575_2620_1504255513680.png">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504255560217_7091_1504255561215.png">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504255577982_489_1504255578997.png">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504256522278_55_1504256523390.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504256546349_6292_1504256547375.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504256755771_6359_1504256756741.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504256789545_3306_1504256790556.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504256938433_6672_1504256939547.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504256997963_7294_1504256998980.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504257016342_3214_1504257017334.jpg">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504257060906_6992_1504257061843.png">
<meta property="og:image" content="https://blog-10039692.file.myqcloud.com/1504257091777_6910_1504257092712.png">
<meta property="og:updated_time" content="2017-09-06T06:08:07.551Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="枫林晚">
<meta name="twitter:description" content="Git 的基本操作、开发流程、实用技巧总结Git 是什么？Git 是一个分布式的代码管理容器，本地和远端都保有一份相同的代码。Git 仓库主要是由是三部分组成：本地代码，缓存区，提交历史，这几乎是所有操作的本质，但是为了文章更加简单易懂，就不围绕这块展开了，有兴趣的可以去了解下。开门见山，我们直接来说说 Git 有哪些常见的操作。 Git 有哪些常规操作？我们简单说说Git有哪些常规操作，能够让我">
<meta name="twitter:image" content="https://blog-10039692.file.myqcloud.com/1504255445680_7621_1504255446676.png">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">枫林晚</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/categories">category</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
          <a class="main-nav-link" href="/atom.xml">rss</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="AdminVen.github.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Git 的基本操作、开发流程、实用技巧总结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/uncategorized/Git 的基本操作、开发流程、实用技巧总结/" class="article-date">
  <time datetime="2017-09-06T06:08:07.551Z" itemprop="datePublished">2017-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Git-的基本操作、开发流程、实用技巧总结"><a href="#Git-的基本操作、开发流程、实用技巧总结" class="headerlink" title="Git 的基本操作、开发流程、实用技巧总结"></a>Git 的基本操作、开发流程、实用技巧总结</h3><h2 id="Git-是什么？"><a href="#Git-是什么？" class="headerlink" title="Git 是什么？"></a>Git 是什么？</h2><p>Git 是一个分布式的代码管理容器，本地和远端都保有一份相同的代码。<br>Git 仓库主要是由是三部分组成：本地代码，缓存区，提交历史，这几乎是所有操作的本质，但是为了文章更加简单易懂，就不围绕这块展开了，有兴趣的可以去了解下。<br>开门见山，我们直接来说说 Git 有哪些常见的操作。</p>
<h2 id="Git-有哪些常规操作？"><a href="#Git-有哪些常规操作？" class="headerlink" title="Git 有哪些常规操作？"></a>Git 有哪些常规操作？</h2><p>我们简单说说Git有哪些常规操作，能够让我们应付简单的开发需求。</p>
<h3 id="克隆代码"><a href="#克隆代码" class="headerlink" title="克隆代码"></a>克隆代码</h3><p>✦ 克隆远端代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone http://git.code.oa.com/QCFE/sqlserver.git</div></pre></td></tr></table></figure>
<p>✦ 查看本地的代码状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 可以明确的呈现出本地仓库的状态</div><div class="line">// 哪些文件发生改动，哪些文件已经提交到本机</div><div class="line">// 以及一些操作指示。</div><div class="line">git status</div></pre></td></tr></table></figure>
<p><img src="https://blog-10039692.file.myqcloud.com/1504255445680_7621_1504255446676.png" alt="img"><br>✦ 同步远端分支变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 拉取指定分支的变化</div><div class="line">git fetch origin master </div><div class="line">// 拉取所有分支的变化</div><div class="line">git fetch </div><div class="line">// 拉取所有分支的变化，并且将远端不存在的分支同步移除【推荐】</div><div class="line">git fetch -p</div></pre></td></tr></table></figure>
<p>✦ 同步远端代码变化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 都是先 git fetch，然后执行合并操作</div><div class="line">// 不同的是，git pull 执行的是 git merge，git pull -r 执行的是git rebase</div><div class="line">git pull origin master </div><div class="line">git pull -r origin master</div></pre></td></tr></table></figure>
<p>关于 git merge 和 git rebase 各自的优劣，后文会详细介绍。</p>
<p>这部分主要介绍了关于代码克隆，同步远端代码变化的相关操作。接下来，我们看看关于本地代码的一些操作。</p>
<h3 id="操作-commit"><a href="#操作-commit" class="headerlink" title="操作 commit"></a>操作 commit</h3><p>首先我们要明确一个概念：就是每个 commit 都是一份完整的代码状态，用一个 commitID 来唯一标志。<br><img src="https://blog-10039692.file.myqcloud.com/1504255512575_2620_1504255513680.png" alt="img"></p>
<p>从某个角度上来说，Git维护的就是一个commitID树，分别保存着不同状态下的代码。<br>所以你对代码的任何修改，最终都会反映到 commit 上面去。</p>
<p>✦ 新增 commit</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// 添加文件到缓存区，然后提交到本地仓库</div><div class="line">git add files</div><div class="line">git commit -m &apos;提交备注&apos;</div></pre></td></tr></table></figure>
<p>✦ 撤销 commit</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// 会将提交记录回滚，代码不回滚</div><div class="line">git reset b14bb52</div><div class="line"></div><div class="line">// 会将提交记录和代码全部回滚</div><div class="line">git reset --hard b14bb52</div><div class="line"></div><div class="line">// 将部分代码文件回滚</div><div class="line">git checkout -- files</div></pre></td></tr></table></figure>
<p>✦ 合并 commit<br>合并 commit，本质上合并两份不同状态下的代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Git 提供了两种合并 commit 的方式</div><div class="line">git merge master</div><div class="line">git rebase master</div></pre></td></tr></table></figure>
<p>那么 git rebase 和 git merge 到底有什么区别呢？<br>merge是两个分支处理冲突后，新增一个 commit 追加到master上。<br>rebase是将someFeature分支上的commit记录追加到主分支上，值得注意的是，这个时候他的commit其实已经发生变化。</p>
<p><img src="https://blog-10039692.file.myqcloud.com/1504255560217_7091_1504255561215.png" alt="img"></p>
<p>相对来说，git merge 处理冲突更直接，而git rebase 能够保证清晰的 commit 记录。<br>合并 commit 的时候，通常会发生冲突。<br>可以全局搜索特殊字符比如&lt;&lt;&lt;，找到需要处理的代码位置，然后认真分析应该保留哪一部分代码。<br><img src="https://blog-10039692.file.myqcloud.com/1504255577982_489_1504255578997.png" alt="img"></p>
<p>在团队协作的时候，分支是必不可少的。那么应该如何对分支进行操作呢？</p>
<h3 id="操作分支"><a href="#操作分支" class="headerlink" title="操作分支"></a>操作分支</h3><p>所谓的分支其实就是一个指向 commitID 的指针，你可以去<code>.git/refs/heads</code>里去看看。</p>
<p><img src="https://blog-10039692.file.myqcloud.com/1504256522278_55_1504256523390.jpg" alt="img"></p>
<p>通常情况下，我们建议分支至少能够明确的标记功能名称，如果能标记用户就更好了，比如<code>qixiu/feature</code>。<br>✦ 查看分支</p>
<p><img src="https://blog-10039692.file.myqcloud.com/1504256546349_6292_1504256547375.jpg" alt="img"></p>
<p>可以同时看到本地分支和远端分支，配合上前文介绍的 git fetch -p 可以第一时间查看到最新的分支信息。<br>✦ 新增本地分支<br>其实就是创建一个指针指向某一个 commitID。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// git branch qixiu/feature + git checkout qixiu/feature</div><div class="line">// 从当前分支新增一个新的分支qixiu/feature</div><div class="line">// 一般情况下，我们应该从master或者其他稳定分支来新增分支</div><div class="line">git checkout -b qixiu/feature // 新建分支</div><div class="line">git checkout qixiu/feature // 切换分支</div></pre></td></tr></table></figure>
<p>✦ 删除本地分支<br>其实就是移除一个指向 commitID 的指针。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 删除本地分支，如果本地还有未合并的代码，则不能删除</div><div class="line">git branch -d qixiu/feature</div><div class="line">// 强制删除本地分支</div><div class="line">git branch -D qixiu/feature</div></pre></td></tr></table></figure>
<p>✦ 新增远端分支<br>通常情况下，我们是新建本地分支，然后更新到远端的方式来新增一个远端分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push origin qixiu/feature</div></pre></td></tr></table></figure>
<p>✦ 删除远端分支<br>同样，我们也是通过更新到远端的方式来删除一个远端分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 等同于git push origin -d qixiu/feaure</div><div class="line">git push origin :qixiu/feature</div></pre></td></tr></table></figure>
<h3 id="简单汇总一下"><a href="#简单汇总一下" class="headerlink" title="简单汇总一下"></a>简单汇总一下</h3><p>上面说的可能有些分散，这儿简单总结一下有哪些经常使用的操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">git status // 查看本地代码状态</div><div class="line">git add files // 添加代码到缓存区</div><div class="line">git commit -m &apos;提交内容的备注&apos; // 提交代码到本地仓库</div><div class="line">git checkout -b branchName // 不加-b就是普通切换分支</div><div class="line">git fetch -p // 同步远端分支状态</div><div class="line">git pull -r origin branchName // fetch远端代码到本地，并且以rebase的方式合并代码</div><div class="line">git push origin branchName // 更新本地代码到远端</div></pre></td></tr></table></figure>
<p>以上几条命令已经能够应付日常的操作，稍微复杂一些的场景后文会介绍</p>
<p>基于基本操作，在实际项目中，我们应该怎么利用 Git 实现协作呢？</p>
<h2 id="Git-有哪些比较好的实践？"><a href="#Git-有哪些比较好的实践？" class="headerlink" title="Git 有哪些比较好的实践？"></a>Git 有哪些比较好的实践？</h2><p>Git 有一些成熟的开发流程，比较主流的有两种：<strong>基于功能分支的开发流程</strong> 和 <strong>GitFlow开发流程。</strong><br>相对来时，我更推荐前者，如果是复杂的大型项目，推荐GitFlow开发流程。<br>接下来，简单介绍下这两种协作模式。</p>
<h3 id="基于功能分支的协作模式"><a href="#基于功能分支的协作模式" class="headerlink" title="基于功能分支的协作模式"></a>基于功能分支的协作模式</h3><p>基于功能分支的开发流程其实就是一句话：用分支来承载功能开发，开发结束之后就合并到 master 分支。<br>他的优点是能够保证master分支的整洁，同时还能让分支代码逻辑集中，也便于 CodeReview。</p>
<p><strong>分支命名规范</strong></p>
<p>推荐使用如下格式：ownerName/featureName。<br>这样既便于知道分支覆盖的功能，也便于找到分支的负责人。以后清理分支的时候也很方便。</p>
<p><strong>开发流程</strong></p>
<p>✦ 从 master 切出一个新分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -b qixiu/newFeature</div></pre></td></tr></table></figure>
<p>✦ 开发一些新功能，然后提交<br>建议较多频次的提交代码到本地仓库，以便能够更灵活的保存或撤销修改。<br>此外为了保证提交日志的清晰，建议备注清楚的注释。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git status</div><div class="line">git add files // 挑选需要提交的文件，或者全部提交</div><div class="line">git commit -m &apos;提交备注&apos;</div><div class="line">git push origin qixiu/newFeature</div></pre></td></tr></table></figure>
<p>✦ 如果功能开发完成，可以发起一个CodeReview流程<br>✦ 如果代码测试通过，合并到 master，然后准备上线</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// 冗余版 合并到 master</div><div class="line">git checkout master </div><div class="line">git pull -r origin master</div><div class="line">git checkout qixiu/newFeature</div><div class="line">git rebase master // 处理冲突</div><div class="line">git checkout master</div><div class="line">git merge qixiu/newFeature</div><div class="line">git push origin master</div><div class="line"></div><div class="line">// 精简版 合并到 master</div><div class="line">git checkout qixiu/newFeature</div><div class="line">git pull -r origin master // 将master的代码更新下来，并且rebase处理冲突</div><div class="line">git push origin master // 将本地代码更新到远端</div></pre></td></tr></table></figure>
<p>有几点需要注意：<br>不要在master合并代码，保证master的可用性很重要。<br>确保在正确的分支执行正确的操作。<br>无论是处理冲突还是更新远端代码，请保有敬畏之心。</p>
<p>到此，一个正常的基于功能分支的开发流程就完成了。接下来看看另外一个开发流程。</p>
<h3 id="GitFlow-开发流程"><a href="#GitFlow-开发流程" class="headerlink" title="GitFlow 开发流程"></a>GitFlow 开发流程</h3><p>GitFlow 比前文讲的基于功能分支的开发流程要复杂得多，它更适合大型的复杂项目。<br>它围绕项目发布流程定义了一个严格的分支模型，所有的开发流程都是围绕这个严格的分支模型进行。<br>而这个模型约定了每个分支的角色，以及他们如何沟通。</p>
<p>我们先来看看 GitFlow 开发流程中几个约定的分支，以及他们各自承担的角色是怎么样的？<br><img src="https://blog-10039692.file.myqcloud.com/1504256755771_6359_1504256756741.jpg" alt="img"></p>
<p>✦ Master分支：用于存放线上版本代码，可以方便的给代码打版本号。<br>✦ Develop分支：用于整合 Feature 分支。<br>✦ Feature分支：某个功能的分支，从 Develop 分支切出，并且功能完成时又合并回 Develop 分支，不直接和<br>Master 分支交互。<br>✦ Release分支：通常对应一个迭代。将一个版本的功能全部合并到 Develop 分支之后，从 Develop 切出一个<br>Release 分支。这个分支不在追加新需求，可以完成 bug 修复、完善文档等工作。务必记住，代码发布后，需要将其合并到 Master 分支，同时也要合并到 Develop 分支。<br>✦ Hotfix分支：紧急修复的分支，是唯一可以从 Master 切出的分支，一旦修复了可以合并到 Master 分支和 Develop 分支。</p>
<p>从每个分支的功能和约定可以看出，它流程多约束多，对于小规模应用并不适合。<br>当然 GitFlow 有一些辅助工具 gitflow 可以自动化的完成这些任务，对于大型项目也很有帮助。</p>
<p>前面讲了 Git 有哪些基本操作，然后介绍了两个主流的工作流程。<br>接下来我们看看 Git 有哪些特别的技巧值得一提。</p>
<h2 id="Git-有哪些小技巧？"><a href="#Git-有哪些小技巧？" class="headerlink" title="Git 有哪些小技巧？"></a>Git 有哪些小技巧？</h2><p>Git 操作除了基本的代码管理功能，还有一些小技巧能够让你眼前一亮。</p>
<h3 id="git-reflog，查看操作记录"><a href="#git-reflog，查看操作记录" class="headerlink" title="git reflog，查看操作记录"></a>git reflog，查看操作记录</h3><p>这个我一定要放在第一个介绍，因为它曾经数次解救了我的代码</p>
<p><img src="https://blog-10039692.file.myqcloud.com/1504256789545_3306_1504256790556.jpg" alt="img"></p>
<p>仔细看上图，reflog 记录了你所有的 git 命令操作，对于复原某些莫名其妙的场景或者回滚误操作有极大的帮助。<br>试想一个场景：你使用 <code>git reset --hard commitID</code> 把本地开发代码回滚到了一个之前的版本，而且还没有推到远端，怎么才能找回丢失的代码呢？<br>你如果使用 git log 查看提交日志，并不能找回丢弃的那些 commitID。<br>而 git reflog 却详细的记录了你每个操作的 commitID，可以轻易的让你复原当时的操作并且找回丢失的代码。<br>当然，如果你丢失的代码都没有提交记录，那么恭喜你，你的代码真的丢了。</p>
<h3 id="压缩提交记录"><a href="#压缩提交记录" class="headerlink" title="压缩提交记录"></a>压缩提交记录</h3><p>这也是一个很实用的功能，前文提过，我们在开发中的时候尽量保持一个较高频率的代码提交，这样可以避免不小心代码丢失。但是真正合并代码的时候，我们并不希望有太多冗余的提交记录，而且 rebase 合并代码的时候，会把每个 commit 都处理一下，有时候会造成冗余的工作。<br>所以，压缩日志之后不经能让 commit 记录非常整洁，同时也便于使用 rebase 合并代码。</p>
<p>那么，如何压缩commit记录呢？<br>✦ 使用 <code>git log</code> 找到起始 commitID<br>✦ <code>git reset commitID</code>，切记不要用 <code>--hard</code>参数<br>✦ 重新 <code>git add &amp;&amp; git commit</code><br>✦ <code>git push -f origin branchName</code>，因为会有冲突，所以需要强制覆盖远端分支，请务必谨慎。<br>✦ 合并到 master 中，然后更新远端 master。</p>
<p>此外还有两种压缩日志的办法：<br><code>git commit --amend</code>：追加 commit 到上一个 commit 上。<br><code>git rebase -i</code>：通过交互式的 rebase，提供对分支 commit 的控制，从而可以清理混乱的历史。<br><img src="https://blog-10039692.file.myqcloud.com/1504256938433_6672_1504256939547.jpg" alt="img"></p>
<p>从实际应用来说，三种日志压缩都很优秀，<code>git reset</code>更简单，<code>git rebase -i</code>更细腻。</p>
<h3 id="git-rebase，合并代码"><a href="#git-rebase，合并代码" class="headerlink" title="git rebase，合并代码"></a>git rebase，合并代码</h3><p>前文简单介绍了<code>git rebase</code>和 <code>git merge</code> 的区别，坦率讲，他们各有优劣。<br><code>git rebase</code>能让你的 commit 记录非常整洁，无论是线上回滚还是 CodeReview 都更轻松；但却是一个有隐患的操作，使用时务必谨慎。<br><code>git merge</code> 操作更安全，同时也更简单；但却会增加一些冗余的 commit 记录。</p>
<p>这儿简单说说 rebase 的合并流程和注意事项吧。看下图</p>
<p><img src="https://blog-10039692.file.myqcloud.com/1504256997963_7294_1504256998980.jpg" alt="img"><br>有三个点需要注意：<br>✦ rebase 先找出共同的祖先节点<br>✦ 从祖先节点把 pay 分支的提交记录摘下来，然后 rebase 到 master 分支<br>✦ rebase 之后的 commitID 其实已经发生了变化<br>尤其是第三点，经常会让人误操作，所以务必注意。</p>
<p>试想一下，开发过程中，如果我们频繁的 rebase master 分支，会有什么后果呢？</p>
<p><img src="https://blog-10039692.file.myqcloud.com/1504257016342_3214_1504257017334.jpg" alt="img"><br>当你不断 rebase master 的时候，其实你本地的 d 都变成了 d’ ，再要和远端 pay 分支保持一致，你的本地分支 commit 记录已经不堪入目了。</p>
<p>另外要注意，<strong>绝不要在公共的分支上使用 rebase！！！</strong><br><img src="https://blog-10039692.file.myqcloud.com/1504257060906_6992_1504257061843.png" alt="img"></p>
<p>所以，为了安全，团队可以考虑采用 merge。</p>
<h3 id="pull-request，方便CodeReview"><a href="#pull-request，方便CodeReview" class="headerlink" title="pull request，方便CodeReview"></a>pull request，方便CodeReview</h3><p>Git 不仅提供了代码托管以及代码开发的帮助，还提供了代码审核类似的功能。<br>当我们在功能分支开发完成之后，可以发起一个 pull request 请求，选择需要对比的两个分支<br><img src="https://blog-10039692.file.myqcloud.com/1504257091777_6910_1504257092712.png" alt="img"></p>
<p>它会创建一个 pull request，制定相关人员来对代码进行 review。<br>通常情况下，团队应该鼓励交叉 review，涉及到公共代码的时候，一定要让相关人 review。</p>
<h3 id="git-hook，Git-的生命周期"><a href="#git-hook，Git-的生命周期" class="headerlink" title="git hook，Git 的生命周期"></a>git hook，Git 的生命周期</h3><p>这个大多数人应该都，听说过，git操作有它自身的生命周期，在不同的生命周期，我们可以做一些自动化的事情。</p>
<p>举两个简单的例子：<br>✦ pre-commit的时候我们可以做 eslint<br>✦ post-commit的时候，我们可以做利用 jenkins 类似的工具做持续集成</p>
<p>当然还有更多的声明周期，具体可以参考 <a href="https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90" target="_blank" rel="external">Git 钩子</a></p>
<h3 id="git-submodule-amp-amp-git-subtree，管理第三方模块"><a href="#git-submodule-amp-amp-git-subtree，管理第三方模块" class="headerlink" title="git submodule &amp;&amp; git subtree，管理第三方模块"></a>git submodule &amp;&amp; git subtree，管理第三方模块</h3><p>这两个命令通常用来管理公用的第三方模块。比如一些通用的底层逻辑、中间件、还有一些可能会频繁变化的通用业务组件。<br>当然，两者还是有区别的。<br><code>git submodule</code> 主要用来管理一些单向更新的公共模块或底层逻辑。<br><code>git subtree</code> 对于部分需要双向更新的可复用逻辑来说，特别适合管理。比如一些需要复用的业务组件代码。在我之前的实践中，我也曾用subtree来管理构建系统逻辑。</p>
<h3 id="git-alias，简化-Git-命令"><a href="#git-alias，简化-Git-命令" class="headerlink" title="git alias，简化 Git 命令"></a>git alias，简化 Git 命令</h3><p>我们可以通过配置 git alias 来简化需要输入的 Git 命令。<br>比如前文的 git subtree 需要输入很长的 Git 命令，我们可以配置 <code>.git/config</code> 文件来解决。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// git stpull appfe demo/xxx</div><div class="line">// git stpush appfe demo/xxx</div><div class="line">[alias]</div><div class="line">    stpull = !git subtree pull --prefix=$1 appfe $2 \</div><div class="line">        &amp;&amp; :</div><div class="line">    stpush = !git subtree pull --prefix=$1 appfe $2 \</div><div class="line">        &amp;&amp; git subtree split --rejoin --prefix=$1 $2 \</div><div class="line">        &amp;&amp; git subtree push --prefix=$1 appfe $2 \</div><div class="line">        &amp;&amp; :</div></pre></td></tr></table></figure>
<h2 id="总结说点啥？"><a href="#总结说点啥？" class="headerlink" title="总结说点啥？"></a>总结说点啥？</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="AdminVen.github.com/uncategorized/Git 的基本操作、开发流程、实用技巧总结/" data-id="cj78mimt00000rovbm2wgeq3y" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/uncategorized/zhuchi/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/uncategorized/Git 的基本操作、开发流程、实用技巧总结/">(no title)</a>
          </li>
        
          <li>
            <a href="/uncategorized/zhuchi/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  
    
  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 star<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/categories" class="mobile-nav-link">category</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
    <a href="/atom.xml" class="mobile-nav-link">rss</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>